<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="elements.html">

<!-- Import project menu -->
<link rel="import" href="project-menu.html">
<!-- Import the form element to interact with project data-->
<link rel="import" href="project-form.html">
<!-- Import project list with core-ajax wiring for data load -->
<link rel="import" href="project-list.html">

<polymer-element name="project-app">
  <template>
    <core-ajax auto url="{{url}}" handleAs="json" response="{{projects}}">
    </core-ajax>
    <style>
      .card {
        margin: 15px;
      }
      core-toolbar {
        background-color: #03A9F4;
        color: white;
      }
      core-overlay {
        border: 1px solid black;
        background-color: white;
        padding: 10px;
      }
      
      paper-button.blue-ripple::shadow #ripple {
        color: #4285f4;
      }
      
      .form {
        width: 800px;
      }
    </style>
    <core-drawer-panel id="drawerPanel">
      <core-header-panel drawer class="tall">
        <core-toolbar>
          <h3>Menu</h3>
        </core-toolbar>
        <!-- 
        Custom element holding menu and items
        Source: project-menu.html
      -->
        <project-menu on-menuItem="{{menuItem}}" id="pMenu"></project-menu>
      </core-header-panel>

      <core-header-panel main class="tall">
        <core-toolbar>
          <core-icon core-drawer-toggle
                     icon="menu" 
                     alt="Menu for narrow displays" 
                     on-tap="{{navIconClick}}">
          </core-icon>
          
          <h3 flex three>Portfolio Project List </h3>
          
          <core-icon id="topAddP" 
               icon="add-circle" 
               alt="Add new project" 
               on-tap="{{topAddPClick}}">
          </core-icon>
<!--
          <core-icon id="topEdit" 
               icon="editor:mode-edit" 
               alt="Edit Project" 
               on-tap="{{topEditClick}}">
          </core-icon>
-->
          <core-icon id="topSearch" 
                     icon="search" 
                     alt="Search">
          </core-icon>


        </core-toolbar>
        <!--
        Custom element holding project list, styles and scripts
        Source: project-list.html
      -->
        <project-list url="projects.json"></project-list>
      </core-header-panel>
    </core-drawer-panel>

    <core-overlay id="addOverlay" backdrop="true" closeSelector="core-icon">
      <core-toolbar class="form">
        <h3 flex three>Add Project</h3>
        <core-icon id="addFormClose" 
             icon="close" 
             alt="Close Form">
        </core-icon>
      </core-toolbar>
      <project-form></project-form>
      <paper-button class="blue-ripple">
        Add Project
      </paper-button>
    </core-overlay>

    <core-overlay id="editOverlay" backdrop="true" closeSelector="core-icon">
      <core-toolbar class="form">
        <h3 flex three>Edit Project</h3>
        <core-icon id="editFormClose" 
                   icon="close" 
                   alt="Close Form">
        </core-icon>
      </core-toolbar>
      <project-form></project-form>
      <paper-button class="blue-ripple">
        Edit Project
      </paper-button>
    </core-overlay>
  </template>
  <script>
    Polymer({
      ready: function () {
        // copy global values into instance properties
        this.$.pMenu.addEventListener("menuItem", function (evt) {
          if (evt.detail === "addNew") {
            console.log(evt);
            this.$.addOverlay.open();
          }
          
          if (evt.detail === "search") {
            console.log(evt);
          }
        }.bind(this));
      },
      
      navIconClick: function (evt, detail) {
        this.$.drawerPanel.togglePanel();
      },
      
      topAddPClick: function (evt, detail) {
        this.$.addOverlay.open();
      },
      
      topEditClick: function (evt, detail) {
        this.$.editOverlay.open();
      }
      
    });
  </script>
</polymer-element>
